<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Determining the minimum sampling size |  Soil Sampling Design</title>
  <meta name="description" content="Soil Sampling Design - SoilFer Project" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Determining the minimum sampling size |  Soil Sampling Design" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/frontcover.png" />
  <meta property="og:description" content="Soil Sampling Design - SoilFer Project" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Determining the minimum sampling size |  Soil Sampling Design" />
  
  <meta name="twitter:description" content="Soil Sampling Design - SoilFer Project" />
  <meta name="twitter:image" content="/images/frontcover.png" />

<meta name="author" content="RodrÃ­guez Lado, L., Angelini, M.E, Nyapwere, N., Luotto, I., Yigini, Y." />


<meta name="date" content="2024-01-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="legacy_data.html"/>
<link rel="next" href="stratified-simple-random-sampling.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="assets/plotly-binding-4.10.0/plotly.js"></script>
<script src="assets/typedarray-0.1/typedarray.min.js"></script>
<link href="assets/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="assets/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="assets/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="assets/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="assets/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-1.3.1/leaflet.js"></script>
<link href="assets/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="assets/proj4-2.6.2/proj4.min.js"></script>
<script src="assets/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="assets/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-binding-2.1.1/leaflet.js"></script>
<link href="assets/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="assets/HomeButton-0.0.1/home-button.js"></script>
<script src="assets/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="assets/clipboard-0.0.1/setClipboardText.js"></script>
<link href="assets/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="assets/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<script src="assets/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="assets/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Soil Samping Design</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Licence</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#basic-concepts-of-soil-sampling"><i class="fa fa-check"></i><b>1.1</b> Basic concepts of soil sampling</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#soil-sampling-for-mapping"><i class="fa fa-check"></i><b>1.2</b> Soil Sampling for Mapping</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#sampling-strategies-in-this-technical-manual"><i class="fa fa-check"></i><b>1.3</b> Sampling strategies in this Technical Manual</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#how-to-use-this-manual"><i class="fa fa-check"></i><b>1.4</b> How to use this manual</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#training-material"><i class="fa fa-check"></i><b>1.5</b> Training material</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="setting-up-the-software-environment.html"><a href="setting-up-the-software-environment.html"><i class="fa fa-check"></i><b>2</b> Setting-up the software environment</a>
<ul>
<li class="chapter" data-level="2.1" data-path="setting-up-the-software-environment.html"><a href="setting-up-the-software-environment.html#use-of-r-rstudio-and-r-packages"><i class="fa fa-check"></i><b>2.1</b> Use of R, RStudio and R Packages</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="setting-up-the-software-environment.html"><a href="setting-up-the-software-environment.html#obtaining-and-installing-r"><i class="fa fa-check"></i><b>2.1.1</b> Obtaining and installing R</a></li>
<li class="chapter" data-level="2.1.2" data-path="setting-up-the-software-environment.html"><a href="setting-up-the-software-environment.html#obtaining-and-installing-rstudio"><i class="fa fa-check"></i><b>2.1.2</b> Obtaining and installing RStudio</a></li>
<li class="chapter" data-level="2.1.3" data-path="setting-up-the-software-environment.html"><a href="setting-up-the-software-environment.html#getting-started-with-r"><i class="fa fa-check"></i><b>2.1.3</b> Getting started with R</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="setting-up-the-software-environment.html"><a href="setting-up-the-software-environment.html#r-packages"><i class="fa fa-check"></i><b>2.2</b> R packages</a></li>
<li class="chapter" data-level="2.3" data-path="setting-up-the-software-environment.html"><a href="setting-up-the-software-environment.html#gee---google-earth-engine"><i class="fa fa-check"></i><b>2.3</b> GEE - google earth engine</a></li>
</ul></li>
<li class="part"><span><b>Part one â Soil Legacy Data</b></span></li>
<li class="chapter" data-level="3" data-path="legacy_data.html"><a href="legacy_data.html"><i class="fa fa-check"></i><b>3</b> Evaluating Soil Legacy Data Sampling for DSM</a>
<ul>
<li class="chapter" data-level="3.1" data-path="legacy_data.html"><a href="legacy_data.html#data-preparation"><i class="fa fa-check"></i><b>3.1</b> Data Preparation</a></li>
<li class="chapter" data-level="3.2" data-path="legacy_data.html"><a href="legacy_data.html#representativeness-of-the-legacy-soil-data"><i class="fa fa-check"></i><b>3.2</b> Representativeness of the Legacy Soil Data</a></li>
</ul></li>
<li class="part"><span><b>I Part two â Soil Sampling Design</b></span></li>
<li class="chapter" data-level="4" data-path="determining-the-minimum-sampling-size.html"><a href="determining-the-minimum-sampling-size.html"><i class="fa fa-check"></i><b>4</b> Determining the minimum sampling size</a></li>
<li class="chapter" data-level="5" data-path="stratified-simple-random-sampling.html"><a href="stratified-simple-random-sampling.html"><i class="fa fa-check"></i><b>5</b> Stratified Simple Random Sampling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="stratified-simple-random-sampling.html"><a href="stratified-simple-random-sampling.html#general-procedure"><i class="fa fa-check"></i><b>5.1</b> General Procedure</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="stratified-simple-random-sampling.html"><a href="stratified-simple-random-sampling.html#strata-creation"><i class="fa fa-check"></i><b>5.1.1</b> Strata creation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="stratified-simple-random-sampling.html"><a href="stratified-simple-random-sampling.html#stratified-random-sampling"><i class="fa fa-check"></i><b>5.2</b> Stratified random sampling</a></li>
<li class="chapter" data-level="5.3" data-path="stratified-simple-random-sampling.html"><a href="stratified-simple-random-sampling.html#stratified-simple-random-sampling-for-large-areas"><i class="fa fa-check"></i><b>5.3</b> Stratified simple random sampling for large areas</a></li>
<li class="chapter" data-level="5.4" data-path="stratified-simple-random-sampling.html"><a href="stratified-simple-random-sampling.html#stratified-simple-regular-sampling"><i class="fa fa-check"></i><b>5.4</b> Stratified simple regular sampling</a></li>
<li class="chapter" data-level="5.5" data-path="stratified-simple-random-sampling.html"><a href="stratified-simple-random-sampling.html#simple-random-sampling-based-on-a-stratified-raster"><i class="fa fa-check"></i><b>5.5</b> Simple Random Sampling based on a stratified raster</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conditioned-latin-hypercube-sampling.html"><a href="conditioned-latin-hypercube-sampling.html"><i class="fa fa-check"></i><b>6</b> Conditioned Latin Hypercube Sampling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="conditioned-latin-hypercube-sampling.html"><a href="conditioned-latin-hypercube-sampling.html#clhs-design"><i class="fa fa-check"></i><b>6.1</b> cLHS Design</a></li>
<li class="chapter" data-level="6.2" data-path="conditioned-latin-hypercube-sampling.html"><a href="conditioned-latin-hypercube-sampling.html#including-existing-legacy-data-in-a-clhs-sampling-design"><i class="fa fa-check"></i><b>6.2</b> Including existing legacy data in a cLHS sampling design</a></li>
<li class="chapter" data-level="6.3" data-path="conditioned-latin-hypercube-sampling.html"><a href="conditioned-latin-hypercube-sampling.html#working-with-large-raster-data"><i class="fa fa-check"></i><b>6.3</b> Working with large raster data</a></li>
<li class="chapter" data-level="6.4" data-path="conditioned-latin-hypercube-sampling.html"><a href="conditioned-latin-hypercube-sampling.html#implementation-of-costconstrained-clhs-sampling"><i class="fa fa-check"></i><b>6.4</b> Implementation of costâconstrained cLHS sampling</a></li>
<li class="chapter" data-level="6.5" data-path="conditioned-latin-hypercube-sampling.html"><a href="conditioned-latin-hypercube-sampling.html#replacement-areas-in-clhs-design"><i class="fa fa-check"></i><b>6.5</b> Replacement areas in cLHS design</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="annex-i-compendium-of-r-scripts.html"><a href="annex-i-compendium-of-r-scripts.html"><i class="fa fa-check"></i>Annex I: Compendium of R scripts</a>
<ul>
<li class="chapter" data-level="" data-path="annex-i-compendium-of-r-scripts.html"><a href="annex-i-compendium-of-r-scripts.html#script-1-introduction-to-r"><i class="fa fa-check"></i>Script 1: Introduction to R</a></li>
<li class="chapter" data-level="" data-path="annex-i-compendium-of-r-scripts.html"><a href="annex-i-compendium-of-r-scripts.html#script-2-download-environmental-covariates"><i class="fa fa-check"></i>Script 2: Download environmental covariates</a></li>
<li class="chapter" data-level="" data-path="annex-i-compendium-of-r-scripts.html"><a href="annex-i-compendium-of-r-scripts.html#script-3-evaluate-legacy-data"><i class="fa fa-check"></i>Script 3: Evaluate Legacy Data</a></li>
<li class="chapter" data-level="" data-path="annex-i-compendium-of-r-scripts.html"><a href="annex-i-compendium-of-r-scripts.html#script-4-calculate-minimum-and-optimal-sample-sizes"><i class="fa fa-check"></i>Script 4: Calculate Minimum and Optimal Sample Sizes</a></li>
<li class="chapter" data-level="" data-path="annex-i-compendium-of-r-scripts.html"><a href="annex-i-compendium-of-r-scripts.html#script-5-stratified-sampling-on-vector-and-raster-data"><i class="fa fa-check"></i>Script 5: Stratified sampling on vector and raster data</a></li>
<li class="chapter" data-level="" data-path="annex-i-compendium-of-r-scripts.html"><a href="annex-i-compendium-of-r-scripts.html#script-6-conditional-latin-hypercube-sampling"><i class="fa fa-check"></i>Script 6: Conditional Latin Hypercube Sampling</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://www.fao.org/global-soil-partnership/" target="blank">Global Soil Partnership</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p><img src="images/frontcover.jpg" style="top:0px;height:150px;" align="right" />
Soil Sampling Design</p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="determining-the-minimum-sampling-size" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Determining the minimum sampling size<a href="determining-the-minimum-sampling-size.html#determining-the-minimum-sampling-size" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Several strategies exist for designing soil sampling, including regular, random, and stratified sampling. Each strategy comes with its own set of advantages and limitations, which must be carefully considered before commencing a soil sampling campaign. Regular sampling, also called grid sampling, is straightforward and ensures uniform coverage, making it suitable for spatial analysis and detecting trends. However, it may introduce bias and miss smallâscale variability. Generally, random sampling may require a larger number of samples to accurately capture soil variability compared to stratified sampling, which is more targeted. Nonetheless, from a statistical standpoint, random sampling is often preferred. It effectively minimizes selection bias by giving every part of the study area an equal chance of being selected. This approach yields a sample that is truly representative of the entire population, leading to more accurate, broadly applicable conclusions. Random sampling also supports valid statistical inferences, ensures reliability of results, and simplifies the estimation of errors, thereby facilitating a broad spectrum of statistical analyses.</p>
<p>The determination of both the number and locations of soil samples is an important element in the success of any sampling campaign. The chosen strategy directly influences the representativeness and accuracy of the soil data collected, which in turn impacts the quality of the conclusions drawn from the study.</p>
<p>In this manual, we make use of the data from Vietnam as stored in the Google Earth repository of FAO-GPS (digital-soil-mapping-gsp-fao) for the Nghe An province. We want to determine the minimal number of soil samples that must be collated to capture at least the 95% of variability within the environmental covariates. The procedure start with random distribution of a low number of samples in the area, determine the values of the spatial covariates, and compare them with those representing the whole diversity in the area at pixel scale. The comparisons are made using the <code>'KullbackâLeibler divergence (KL)'</code> â a measure of how the probability distribution of the information in the samples is different from that of the Population, i.e.Â the covariate space. We also calculate the <code>'% of representativeness'</code> as the percent of variability in the covariate information for the complete area related to the variability of covariate information in the sample dataset.</p>
<p>The initial section of the script is related to setâup options in the methodology. We load of R packages, define the working directory, load covariate data, and store it as <code>SpatRaster</code> object. Variables related to several aspects of the analyses, such as the aggregation factor of covariates (optional), the creation of a raster stack object(required in the <code>clhs</code> function), the initial and final number of samples in the trials, the increment step between trials, and the number of iterations within each trial, are also defined.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="determining-the-minimum-sampling-size.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Path to rasters</span></span>
<span id="cb7-2"><a href="determining-the-minimum-sampling-size.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  raster.path <span class="ot">&lt;-</span> <span class="st">&quot;data/rasters&quot;</span></span>
<span id="cb7-3"><a href="determining-the-minimum-sampling-size.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Path to shapes</span></span>
<span id="cb7-4"><a href="determining-the-minimum-sampling-size.html#cb7-4" aria-hidden="true" tabindex="-1"></a>  shp.path <span class="ot">&lt;-</span> <span class="st">&quot;data/shapes&quot;</span></span>
<span id="cb7-5"><a href="determining-the-minimum-sampling-size.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Path to results</span></span>
<span id="cb7-6"><a href="determining-the-minimum-sampling-size.html#cb7-6" aria-hidden="true" tabindex="-1"></a>  results.path <span class="ot">&lt;-</span> <span class="st">&quot;data/results/&quot;</span></span>
<span id="cb7-7"><a href="determining-the-minimum-sampling-size.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Path to additional data</span></span>
<span id="cb7-8"><a href="determining-the-minimum-sampling-size.html#cb7-8" aria-hidden="true" tabindex="-1"></a>  other.path <span class="ot">&lt;-</span> <span class="st">&quot;data/other/&quot;</span></span>
<span id="cb7-9"><a href="determining-the-minimum-sampling-size.html#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregation factor for up-scaling raster covariates (optional)</span></span>
<span id="cb7-10"><a href="determining-the-minimum-sampling-size.html#cb7-10" aria-hidden="true" tabindex="-1"></a>  agg.factor <span class="ot">=</span> <span class="dv">5</span></span></code></pre></div>
<p>As in the previous section, covariates are PCA-transformed to avoid collinearity in the data and Principal Component rasters representing 99% of the information are retained for the analyses.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="determining-the-minimum-sampling-size.html#cb8-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Load raster covariate data</span></span>
<span id="cb8-2"><a href="determining-the-minimum-sampling-size.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read Spatial data covariates as rasters with terra</span></span>
<span id="cb8-3"><a href="determining-the-minimum-sampling-size.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  cov.dat <span class="ot">&lt;-</span>  <span class="fu">list.files</span>(raster.path, <span class="at">pattern =</span> <span class="st">&quot;tif$&quot;</span>,  <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-4"><a href="determining-the-minimum-sampling-size.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  cov.dat <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(cov.dat) <span class="co"># SpatRaster from terra</span></span>
<span id="cb8-5"><a href="determining-the-minimum-sampling-size.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Aggregate stack to simplify data rasters for calculations </span></span>
<span id="cb8-6"><a href="determining-the-minimum-sampling-size.html#cb8-6" aria-hidden="true" tabindex="-1"></a>  cov.dat <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(cov.dat, <span class="at">fact=</span>agg.factor, <span class="at">fun=</span><span class="st">&quot;mean&quot;</span>)</span>
<span id="cb8-7"><a href="determining-the-minimum-sampling-size.html#cb8-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-8"><a href="determining-the-minimum-sampling-size.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load shape of district</span></span>
<span id="cb8-9"><a href="determining-the-minimum-sampling-size.html#cb8-9" aria-hidden="true" tabindex="-1"></a>  nghe <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="fu">file.path</span>(<span class="fu">paste0</span>(shp.path,<span class="st">&quot;/Nghe_An.shp&quot;</span>)),<span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-10"><a href="determining-the-minimum-sampling-size.html#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="determining-the-minimum-sampling-size.html#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Crop covariates on administrative boundary</span></span>
<span id="cb8-12"><a href="determining-the-minimum-sampling-size.html#cb8-12" aria-hidden="true" tabindex="-1"></a>  cov.dat <span class="ot">&lt;-</span> <span class="fu">crop</span>(cov.dat, nghe, <span class="at">mask=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-13"><a href="determining-the-minimum-sampling-size.html#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="determining-the-minimum-sampling-size.html#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simplify raster information with PCA</span></span>
<span id="cb8-15"><a href="determining-the-minimum-sampling-size.html#cb8-15" aria-hidden="true" tabindex="-1"></a>  pca <span class="ot">&lt;-</span> <span class="fu">raster_pca</span>(cov.dat)</span>
<span id="cb8-16"><a href="determining-the-minimum-sampling-size.html#cb8-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-17"><a href="determining-the-minimum-sampling-size.html#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get SpatRaster layers</span></span>
<span id="cb8-18"><a href="determining-the-minimum-sampling-size.html#cb8-18" aria-hidden="true" tabindex="-1"></a>  cov.dat <span class="ot">&lt;-</span> pca<span class="sc">$</span>PCA</span>
<span id="cb8-19"><a href="determining-the-minimum-sampling-size.html#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a raster stack to be used as input in the clhs::clhs function </span></span>
<span id="cb8-20"><a href="determining-the-minimum-sampling-size.html#cb8-20" aria-hidden="true" tabindex="-1"></a>  cov.dat.ras <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">stack</span>(cov.dat) </span>
<span id="cb8-21"><a href="determining-the-minimum-sampling-size.html#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset rasters</span></span>
<span id="cb8-22"><a href="determining-the-minimum-sampling-size.html#cb8-22" aria-hidden="true" tabindex="-1"></a>  cov.dat <span class="ot">&lt;-</span> pca<span class="sc">$</span>PCA[[<span class="dv">1</span><span class="sc">:</span><span class="fu">first</span>(<span class="fu">which</span>(pca<span class="sc">$</span>summaryPCA[<span class="dv">3</span>,]<span class="sc">&gt;</span><span class="fl">0.99</span>))]]</span>
<span id="cb8-23"><a href="determining-the-minimum-sampling-size.html#cb8-23" aria-hidden="true" tabindex="-1"></a>  cov.dat.ras <span class="ot">&lt;-</span>  cov.dat.ras[[<span class="dv">1</span><span class="sc">:</span><span class="fu">first</span>(<span class="fu">which</span>(pca<span class="sc">$</span>summaryPCA[<span class="dv">3</span>,]<span class="sc">&gt;</span><span class="fl">0.99</span>))]]</span>
<span id="cb8-24"><a href="determining-the-minimum-sampling-size.html#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert to dataframe</span></span>
<span id="cb8-25"><a href="determining-the-minimum-sampling-size.html#cb8-25" aria-hidden="true" tabindex="-1"></a>  cov.dat.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cov.dat)</span></code></pre></div>
<p>Fig. <a href="determining-the-minimum-sampling-size.html#fig:fig-5">4.1</a> shows the covariates retained for the analyses.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="determining-the-minimum-sampling-size.html#cb9-1" aria-hidden="true" tabindex="-1"></a>   <span class="fu">plot</span>(cov.dat)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-5"></span>
<img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/fig-5-1.png" alt="Plot of the covariates" width="672" />
<p class="caption">
Figure 4.1: Plot of the covariates
</p>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="determining-the-minimum-sampling-size.html#cb10-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Define the number of samples to be tested in a loop (from initial to final) and the step of the sequence</span></span>
<span id="cb10-2"><a href="determining-the-minimum-sampling-size.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  initial.n <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># Initial sampling size to test</span></span>
<span id="cb10-3"><a href="determining-the-minimum-sampling-size.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  final.n <span class="ot">&lt;-</span> <span class="dv">250</span> <span class="co"># Final sampling size to test</span></span>
<span id="cb10-4"><a href="determining-the-minimum-sampling-size.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  by.n <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Increment size</span></span>
<span id="cb10-5"><a href="determining-the-minimum-sampling-size.html#cb10-5" aria-hidden="true" tabindex="-1"></a>  iters <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Number of trials on each size</span></span></code></pre></div>
<p>The second section is where the analyses of divergence and representativeness of the sampling scheme are calculated.</p>
<p>The analyses are performed in a loop using growing numbers of samples at each trial. Some empty vectors are defined to store the output results at each loop. At each trial of sample size <code>'N'</code>, soil samples are located at locations where the amount of information in the covariates is maximized according to the conditioned Latin Hypercube sampling method in the <code>'clhs'</code> package <span class="citation">(<a href="#ref-Roudier2011" role="doc-biblioref">Roudier <em>et al.</em>, 2011</a>)</span>. A number of 10 replicates are calculated to determine the amount interâvariability in KL divergence and representativeness in the trial. The final results for each sample size correspond to the mean results obtained from each iteration at the corresponding sample size. The minimum sample size selected correspond to the size that accounts for at least 95% of the variability of information in the covariates within the area. The optimal sampling schema proposed correspond to the random scheme at the minimum sample size with higher value of representativeness.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="determining-the-minimum-sampling-size.html#cb11-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define empty vectors to store results</span></span>
<span id="cb11-2"><a href="determining-the-minimum-sampling-size.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  number_of_samples <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb11-3"><a href="determining-the-minimum-sampling-size.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  prop_explained <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb11-4"><a href="determining-the-minimum-sampling-size.html#cb11-4" aria-hidden="true" tabindex="-1"></a>  klo_samples <span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb11-5"><a href="determining-the-minimum-sampling-size.html#cb11-5" aria-hidden="true" tabindex="-1"></a>  samples_storage <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-6"><a href="determining-the-minimum-sampling-size.html#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="determining-the-minimum-sampling-size.html#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (trial <span class="cf">in</span> <span class="fu">seq</span>(initial.n, final.n, <span class="at">by =</span> by.n)) {</span>
<span id="cb11-8"><a href="determining-the-minimum-sampling-size.html#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (iteration <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iters) {</span>
<span id="cb11-9"><a href="determining-the-minimum-sampling-size.html#cb11-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Generate stratified clhs samples</span></span>
<span id="cb11-10"><a href="determining-the-minimum-sampling-size.html#cb11-10" aria-hidden="true" tabindex="-1"></a>      p.dat_I <span class="ot">&lt;-</span>  <span class="fu">clhs</span>(cov.dat.ras,</span>
<span id="cb11-11"><a href="determining-the-minimum-sampling-size.html#cb11-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> trial, <span class="at">iter =</span> <span class="dv">10000</span>,</span>
<span id="cb11-12"><a href="determining-the-minimum-sampling-size.html#cb11-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">progress =</span> <span class="cn">FALSE</span>, <span class="at">simple =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-13"><a href="determining-the-minimum-sampling-size.html#cb11-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-14"><a href="determining-the-minimum-sampling-size.html#cb11-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get covariate values for each point</span></span>
<span id="cb11-15"><a href="determining-the-minimum-sampling-size.html#cb11-15" aria-hidden="true" tabindex="-1"></a>      p.dat_I <span class="ot">&lt;-</span> p.dat_I<span class="sc">$</span>sampled_data</span>
<span id="cb11-16"><a href="determining-the-minimum-sampling-size.html#cb11-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get the covariate values at points as dataframe and delete NAs</span></span>
<span id="cb11-17"><a href="determining-the-minimum-sampling-size.html#cb11-17" aria-hidden="true" tabindex="-1"></a>      p.dat_I.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(p.dat_I<span class="sc">@</span>data) <span class="sc">%&gt;%</span></span>
<span id="cb11-18"><a href="determining-the-minimum-sampling-size.html#cb11-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">na.omit</span>()</span>
<span id="cb11-19"><a href="determining-the-minimum-sampling-size.html#cb11-19" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-20"><a href="determining-the-minimum-sampling-size.html#cb11-20" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store samples as list with point coordinates</span></span>
<span id="cb11-21"><a href="determining-the-minimum-sampling-size.html#cb11-21" aria-hidden="true" tabindex="-1"></a>      samples_storage[[<span class="fu">paste0</span>(<span class="st">&quot;N&quot;</span>, trial, <span class="st">&quot;_&quot;</span>, iteration)]] <span class="ot">&lt;-</span> p.dat_I</span>
<span id="cb11-22"><a href="determining-the-minimum-sampling-size.html#cb11-22" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-23"><a href="determining-the-minimum-sampling-size.html#cb11-23" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Comparison of population and sample distributions - Kullback-Leibler (KL) divergence</span></span>
<span id="cb11-24"><a href="determining-the-minimum-sampling-size.html#cb11-24" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Define quantiles of the study area (number of bins)</span></span>
<span id="cb11-25"><a href="determining-the-minimum-sampling-size.html#cb11-25" aria-hidden="true" tabindex="-1"></a>      nb <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb11-26"><a href="determining-the-minimum-sampling-size.html#cb11-26" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Quantile matrix of the covariate data</span></span>
<span id="cb11-27"><a href="determining-the-minimum-sampling-size.html#cb11-27" aria-hidden="true" tabindex="-1"></a>      q.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> (nb <span class="sc">+</span> <span class="dv">1</span>), <span class="at">ncol =</span> <span class="fu">nlyr</span>(cov.dat))</span>
<span id="cb11-28"><a href="determining-the-minimum-sampling-size.html#cb11-28" aria-hidden="true" tabindex="-1"></a>      j <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb11-29"><a href="determining-the-minimum-sampling-size.html#cb11-29" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nlyr</span>(cov.dat)) {</span>
<span id="cb11-30"><a href="determining-the-minimum-sampling-size.html#cb11-30" aria-hidden="true" tabindex="-1"></a>        ran1 <span class="ot">&lt;-</span> <span class="fu">minmax</span>(cov.dat[[i]])[<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">minmax</span>(cov.dat[[i]])[<span class="dv">1</span>]</span>
<span id="cb11-31"><a href="determining-the-minimum-sampling-size.html#cb11-31" aria-hidden="true" tabindex="-1"></a>        step1 <span class="ot">&lt;-</span> ran1 <span class="sc">/</span> nb</span>
<span id="cb11-32"><a href="determining-the-minimum-sampling-size.html#cb11-32" aria-hidden="true" tabindex="-1"></a>        q.mat[, j] <span class="ot">&lt;-</span></span>
<span id="cb11-33"><a href="determining-the-minimum-sampling-size.html#cb11-33" aria-hidden="true" tabindex="-1"></a>          <span class="fu">seq</span>(<span class="fu">minmax</span>(cov.dat[[i]])[<span class="dv">1</span>],</span>
<span id="cb11-34"><a href="determining-the-minimum-sampling-size.html#cb11-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">to =</span> <span class="fu">minmax</span>(cov.dat[[i]])[<span class="dv">2</span>],</span>
<span id="cb11-35"><a href="determining-the-minimum-sampling-size.html#cb11-35" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> step1)</span>
<span id="cb11-36"><a href="determining-the-minimum-sampling-size.html#cb11-36" aria-hidden="true" tabindex="-1"></a>        j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-37"><a href="determining-the-minimum-sampling-size.html#cb11-37" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb11-38"><a href="determining-the-minimum-sampling-size.html#cb11-38" aria-hidden="true" tabindex="-1"></a>      <span class="co"># q.mat</span></span>
<span id="cb11-39"><a href="determining-the-minimum-sampling-size.html#cb11-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-40"><a href="determining-the-minimum-sampling-size.html#cb11-40" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Hypercube of covariates in study area</span></span>
<span id="cb11-41"><a href="determining-the-minimum-sampling-size.html#cb11-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Initialize the covariate matrix</span></span>
<span id="cb11-42"><a href="determining-the-minimum-sampling-size.html#cb11-42" aria-hidden="true" tabindex="-1"></a>      cov.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow =</span> nb, <span class="at">ncol =</span> <span class="fu">ncol</span>(q.mat))</span>
<span id="cb11-43"><a href="determining-the-minimum-sampling-size.html#cb11-43" aria-hidden="true" tabindex="-1"></a>      cov.dat.mx <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(cov.dat.df)</span>
<span id="cb11-44"><a href="determining-the-minimum-sampling-size.html#cb11-44" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cov.dat.mx)) {</span>
<span id="cb11-45"><a href="determining-the-minimum-sampling-size.html#cb11-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(cov.dat.mx)) {</span>
<span id="cb11-46"><a href="determining-the-minimum-sampling-size.html#cb11-46" aria-hidden="true" tabindex="-1"></a>          dd <span class="ot">&lt;-</span> cov.dat.mx[[i, j]]</span>
<span id="cb11-47"><a href="determining-the-minimum-sampling-size.html#cb11-47" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-48"><a href="determining-the-minimum-sampling-size.html#cb11-48" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(dd)) {</span>
<span id="cb11-49"><a href="determining-the-minimum-sampling-size.html#cb11-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nb) {</span>
<span id="cb11-50"><a href="determining-the-minimum-sampling-size.html#cb11-50" aria-hidden="true" tabindex="-1"></a>              kl <span class="ot">&lt;-</span> q.mat[k, j]</span>
<span id="cb11-51"><a href="determining-the-minimum-sampling-size.html#cb11-51" aria-hidden="true" tabindex="-1"></a>              ku <span class="ot">&lt;-</span> q.mat[k <span class="sc">+</span> <span class="dv">1</span>, j]</span>
<span id="cb11-52"><a href="determining-the-minimum-sampling-size.html#cb11-52" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb11-53"><a href="determining-the-minimum-sampling-size.html#cb11-53" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> (dd <span class="sc">&gt;=</span> kl <span class="sc">&amp;&amp;</span> dd <span class="sc">&lt;=</span> ku) {</span>
<span id="cb11-54"><a href="determining-the-minimum-sampling-size.html#cb11-54" aria-hidden="true" tabindex="-1"></a>                cov.mat[k, j] <span class="ot">&lt;-</span> cov.mat[k, j] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-55"><a href="determining-the-minimum-sampling-size.html#cb11-55" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb11-56"><a href="determining-the-minimum-sampling-size.html#cb11-56" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb11-57"><a href="determining-the-minimum-sampling-size.html#cb11-57" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb11-58"><a href="determining-the-minimum-sampling-size.html#cb11-58" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb11-59"><a href="determining-the-minimum-sampling-size.html#cb11-59" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb11-60"><a href="determining-the-minimum-sampling-size.html#cb11-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-61"><a href="determining-the-minimum-sampling-size.html#cb11-61" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Compare whole study area covariate space with the selected sample</span></span>
<span id="cb11-62"><a href="determining-the-minimum-sampling-size.html#cb11-62" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Sample data hypercube (the same as for the raster data but on the sample data)</span></span>
<span id="cb11-63"><a href="determining-the-minimum-sampling-size.html#cb11-63" aria-hidden="true" tabindex="-1"></a>      h.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow =</span> nb, <span class="at">ncol =</span> <span class="fu">ncol</span>(q.mat))</span>
<span id="cb11-64"><a href="determining-the-minimum-sampling-size.html#cb11-64" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(p.dat_I.df)) {</span>
<span id="cb11-65"><a href="determining-the-minimum-sampling-size.html#cb11-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(p.dat_I.df)) {</span>
<span id="cb11-66"><a href="determining-the-minimum-sampling-size.html#cb11-66" aria-hidden="true" tabindex="-1"></a>          dd <span class="ot">&lt;-</span> p.dat_I.df[i, j]</span>
<span id="cb11-67"><a href="determining-the-minimum-sampling-size.html#cb11-67" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb11-68"><a href="determining-the-minimum-sampling-size.html#cb11-68" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(dd)) {</span>
<span id="cb11-69"><a href="determining-the-minimum-sampling-size.html#cb11-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nb) {</span>
<span id="cb11-70"><a href="determining-the-minimum-sampling-size.html#cb11-70" aria-hidden="true" tabindex="-1"></a>              kl <span class="ot">&lt;-</span> q.mat[k, j]</span>
<span id="cb11-71"><a href="determining-the-minimum-sampling-size.html#cb11-71" aria-hidden="true" tabindex="-1"></a>              ku <span class="ot">&lt;-</span> q.mat[k <span class="sc">+</span> <span class="dv">1</span>, j]</span>
<span id="cb11-72"><a href="determining-the-minimum-sampling-size.html#cb11-72" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb11-73"><a href="determining-the-minimum-sampling-size.html#cb11-73" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> (dd <span class="sc">&gt;=</span> kl <span class="sc">&amp;&amp;</span> dd <span class="sc">&lt;=</span> ku) {</span>
<span id="cb11-74"><a href="determining-the-minimum-sampling-size.html#cb11-74" aria-hidden="true" tabindex="-1"></a>                h.mat[k, j] <span class="ot">&lt;-</span> h.mat[k, j] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-75"><a href="determining-the-minimum-sampling-size.html#cb11-75" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb11-76"><a href="determining-the-minimum-sampling-size.html#cb11-76" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb11-77"><a href="determining-the-minimum-sampling-size.html#cb11-77" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb11-78"><a href="determining-the-minimum-sampling-size.html#cb11-78" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb11-79"><a href="determining-the-minimum-sampling-size.html#cb11-79" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb11-80"><a href="determining-the-minimum-sampling-size.html#cb11-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-81"><a href="determining-the-minimum-sampling-size.html#cb11-81" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Compute Kullback-Leibler (KL) divergence</span></span>
<span id="cb11-82"><a href="determining-the-minimum-sampling-size.html#cb11-82" aria-hidden="true" tabindex="-1"></a>      kl.index <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb11-83"><a href="determining-the-minimum-sampling-size.html#cb11-83" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(cov.dat.df)) {</span>
<span id="cb11-84"><a href="determining-the-minimum-sampling-size.html#cb11-84" aria-hidden="true" tabindex="-1"></a>        kl <span class="ot">&lt;-</span>    <span class="fu">KL.empirical</span>(<span class="fu">c</span>(cov.mat[, i]), <span class="fu">c</span>(h.mat[, i]))</span>
<span id="cb11-85"><a href="determining-the-minimum-sampling-size.html#cb11-85" aria-hidden="true" tabindex="-1"></a>        kl.index <span class="ot">&lt;-</span> <span class="fu">c</span>(kl.index, kl)</span>
<span id="cb11-86"><a href="determining-the-minimum-sampling-size.html#cb11-86" aria-hidden="true" tabindex="-1"></a>        klo <span class="ot">&lt;-</span>  <span class="fu">mean</span>(kl.index)</span>
<span id="cb11-87"><a href="determining-the-minimum-sampling-size.html#cb11-87" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb11-88"><a href="determining-the-minimum-sampling-size.html#cb11-88" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-89"><a href="determining-the-minimum-sampling-size.html#cb11-89" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Calculate the proportion of &quot;env. variables&quot; in the covariate spectra that fall within the convex hull of variables in the &quot;environmental sample space&quot;</span></span>
<span id="cb11-90"><a href="determining-the-minimum-sampling-size.html#cb11-90" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Principal component of the data sample</span></span>
<span id="cb11-91"><a href="determining-the-minimum-sampling-size.html#cb11-91" aria-hidden="true" tabindex="-1"></a>      pca.s <span class="ot">=</span> <span class="fu">prcomp</span>(p.dat_I.df, <span class="at">scale =</span> <span class="cn">TRUE</span>, <span class="at">center =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-92"><a href="determining-the-minimum-sampling-size.html#cb11-92" aria-hidden="true" tabindex="-1"></a>      scores_pca1 <span class="ot">=</span> <span class="fu">as.data.frame</span>(pca.s<span class="sc">$</span>x)</span>
<span id="cb11-93"><a href="determining-the-minimum-sampling-size.html#cb11-93" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Plot the first 2 principal components and convex hull</span></span>
<span id="cb11-94"><a href="determining-the-minimum-sampling-size.html#cb11-94" aria-hidden="true" tabindex="-1"></a>      rand.tr <span class="ot">&lt;-</span></span>
<span id="cb11-95"><a href="determining-the-minimum-sampling-size.html#cb11-95" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tri.mesh</span>(scores_pca1[, <span class="dv">1</span>], scores_pca1[, <span class="dv">2</span>], <span class="st">&quot;remove&quot;</span>) <span class="co"># Delaunay triangulation</span></span>
<span id="cb11-96"><a href="determining-the-minimum-sampling-size.html#cb11-96" aria-hidden="true" tabindex="-1"></a>      rand.ch <span class="ot">&lt;-</span> <span class="fu">convex.hull</span>(rand.tr, <span class="at">plot.it =</span> F) <span class="co"># convex hull</span></span>
<span id="cb11-97"><a href="determining-the-minimum-sampling-size.html#cb11-97" aria-hidden="true" tabindex="-1"></a>      pr_poly <span class="ot">&lt;-</span></span>
<span id="cb11-98"><a href="determining-the-minimum-sampling-size.html#cb11-98" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(<span class="at">x =</span> <span class="fu">c</span>(rand.ch<span class="sc">$</span>x), <span class="at">y =</span> <span class="fu">c</span>(rand.ch<span class="sc">$</span>y)) <span class="co"># save the convex hull vertices</span></span>
<span id="cb11-99"><a href="determining-the-minimum-sampling-size.html#cb11-99" aria-hidden="true" tabindex="-1"></a>      <span class="co"># PCA projection of study area population onto the principal components</span></span>
<span id="cb11-100"><a href="determining-the-minimum-sampling-size.html#cb11-100" aria-hidden="true" tabindex="-1"></a>      PCA_projection <span class="ot">&lt;-</span></span>
<span id="cb11-101"><a href="determining-the-minimum-sampling-size.html#cb11-101" aria-hidden="true" tabindex="-1"></a>        <span class="fu">predict</span>(pca.s, cov.dat.df) <span class="co"># Project study area population onto sample PC</span></span>
<span id="cb11-102"><a href="determining-the-minimum-sampling-size.html#cb11-102" aria-hidden="true" tabindex="-1"></a>      newScores <span class="ot">=</span> <span class="fu">cbind</span>(<span class="at">x =</span> PCA_projection[, <span class="dv">1</span>], <span class="at">y =</span> PCA_projection[, <span class="dv">2</span>]) <span class="co"># PC scores of projected population</span></span>
<span id="cb11-103"><a href="determining-the-minimum-sampling-size.html#cb11-103" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check which points fall within the polygon</span></span>
<span id="cb11-104"><a href="determining-the-minimum-sampling-size.html#cb11-104" aria-hidden="true" tabindex="-1"></a>      pip <span class="ot">&lt;-</span></span>
<span id="cb11-105"><a href="determining-the-minimum-sampling-size.html#cb11-105" aria-hidden="true" tabindex="-1"></a>        <span class="fu">point.in.polygon</span>(newScores[, <span class="dv">2</span>], newScores[, <span class="dv">1</span>], pr_poly[, <span class="dv">2</span>], pr_poly[, <span class="dv">1</span>], <span class="at">mode.checked =</span></span>
<span id="cb11-106"><a href="determining-the-minimum-sampling-size.html#cb11-106" aria-hidden="true" tabindex="-1"></a>                           <span class="cn">FALSE</span>)</span>
<span id="cb11-107"><a href="determining-the-minimum-sampling-size.html#cb11-107" aria-hidden="true" tabindex="-1"></a>      newScores <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(newScores, pip))</span>
<span id="cb11-108"><a href="determining-the-minimum-sampling-size.html#cb11-108" aria-hidden="true" tabindex="-1"></a>      klo_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(klo_samples, klo)</span>
<span id="cb11-109"><a href="determining-the-minimum-sampling-size.html#cb11-109" aria-hidden="true" tabindex="-1"></a>      prop_explained <span class="ot">&lt;-</span></span>
<span id="cb11-110"><a href="determining-the-minimum-sampling-size.html#cb11-110" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(prop_explained, <span class="fu">sum</span>(newScores<span class="sc">$</span>pip) <span class="sc">/</span> <span class="fu">nrow</span>(newScores) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb11-111"><a href="determining-the-minimum-sampling-size.html#cb11-111" aria-hidden="true" tabindex="-1"></a>      number_of_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(number_of_samples, trial)</span>
<span id="cb11-112"><a href="determining-the-minimum-sampling-size.html#cb11-112" aria-hidden="true" tabindex="-1"></a>      <span class="co"># print(</span></span>
<span id="cb11-113"><a href="determining-the-minimum-sampling-size.html#cb11-113" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   paste(</span></span>
<span id="cb11-114"><a href="determining-the-minimum-sampling-size.html#cb11-114" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     &quot;N samples = &quot;,</span></span>
<span id="cb11-115"><a href="determining-the-minimum-sampling-size.html#cb11-115" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     trial,</span></span>
<span id="cb11-116"><a href="determining-the-minimum-sampling-size.html#cb11-116" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     &quot; out of &quot;,</span></span>
<span id="cb11-117"><a href="determining-the-minimum-sampling-size.html#cb11-117" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     final.n,</span></span>
<span id="cb11-118"><a href="determining-the-minimum-sampling-size.html#cb11-118" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     &quot;; iteration = &quot;,</span></span>
<span id="cb11-119"><a href="determining-the-minimum-sampling-size.html#cb11-119" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     iteration,</span></span>
<span id="cb11-120"><a href="determining-the-minimum-sampling-size.html#cb11-120" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     &quot;; KL = &quot;,</span></span>
<span id="cb11-121"><a href="determining-the-minimum-sampling-size.html#cb11-121" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     klo,</span></span>
<span id="cb11-122"><a href="determining-the-minimum-sampling-size.html#cb11-122" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     &quot;; Proportion = &quot;,</span></span>
<span id="cb11-123"><a href="determining-the-minimum-sampling-size.html#cb11-123" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     sum(newScores$pip) / nrow(newScores) * 100</span></span>
<span id="cb11-124"><a href="determining-the-minimum-sampling-size.html#cb11-124" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   )</span></span>
<span id="cb11-125"><a href="determining-the-minimum-sampling-size.html#cb11-125" aria-hidden="true" tabindex="-1"></a>      <span class="co"># )</span></span>
<span id="cb11-126"><a href="determining-the-minimum-sampling-size.html#cb11-126" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-127"><a href="determining-the-minimum-sampling-size.html#cb11-127" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<p>Figure <a href="determining-the-minimum-sampling-size.html#fig:fig-7">4.2</a> shows the distribution of covariates in the sample space, and Figure <a href="determining-the-minimum-sampling-size.html#fig:fig-7a">4.3</a> indicates the variability in the estimations of KL divergence and repressentativeness percent in the 10 within each sample size.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="determining-the-minimum-sampling-size.html#cb12-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the polygon and all points to be checked</span></span>
<span id="cb12-2"><a href="determining-the-minimum-sampling-size.html#cb12-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">plot</span>(newScores[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">xlab=</span><span class="st">&quot;PCA 1&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PCA 2&quot;</span>,</span>
<span id="cb12-3"><a href="determining-the-minimum-sampling-size.html#cb12-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">min</span>(newScores[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">na.rm =</span> T), <span class="fu">max</span>(newScores[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">na.rm =</span> T)),</span>
<span id="cb12-4"><a href="determining-the-minimum-sampling-size.html#cb12-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim=</span><span class="fu">c</span>(<span class="fu">min</span>(newScores[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">na.rm =</span> T), <span class="fu">max</span>(newScores[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">na.rm =</span> T)),</span>
<span id="cb12-5"><a href="determining-the-minimum-sampling-size.html#cb12-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">&#39;black&#39;</span>,</span>
<span id="cb12-6"><a href="determining-the-minimum-sampling-size.html#cb12-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">&#39;Environmental space plots over the convex hull of soil legacy data&#39;</span>)</span>
<span id="cb12-7"><a href="determining-the-minimum-sampling-size.html#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="determining-the-minimum-sampling-size.html#cb12-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">polygon</span>(pr_poly,<span class="at">col=</span><span class="st">&#39;#99999990&#39;</span>)</span>
<span id="cb12-9"><a href="determining-the-minimum-sampling-size.html#cb12-9" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb12-10"><a href="determining-the-minimum-sampling-size.html#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # Plot points outside convex hull  </span></span>
<span id="cb12-11"><a href="determining-the-minimum-sampling-size.html#cb12-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">points</span>(newScores[<span class="fu">which</span>(newScores<span class="sc">$</span>pip<span class="sc">==</span><span class="dv">0</span>),<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">pch=</span><span class="dv">12</span>, <span class="at">cex =</span><span class="dv">1</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-7"></span>
<img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/fig-7-1.png" alt="Distribution of covariates in the sample space" width="672" />
<p class="caption">
Figure 4.2: Distribution of covariates in the sample space
</p>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="determining-the-minimum-sampling-size.html#cb13-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Plot dispersion on KL and % by N</span></span>
<span id="cb13-2"><a href="determining-the-minimum-sampling-size.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb13-3"><a href="determining-the-minimum-sampling-size.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boxplot</span>(Perc <span class="sc">~</span> N, <span class="at">data=</span>results, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>),<span class="at">ylab =</span> <span class="st">&quot;%&quot;</span>)</span>
<span id="cb13-4"><a href="determining-the-minimum-sampling-size.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="st">&quot;KL divergence&quot;</span>,<span class="at">side=</span><span class="dv">4</span>,<span class="at">line=</span><span class="dv">3</span>)</span>
<span id="cb13-5"><a href="determining-the-minimum-sampling-size.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add new plot</span></span>
<span id="cb13-6"><a href="determining-the-minimum-sampling-size.html#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>,<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb13-7"><a href="determining-the-minimum-sampling-size.html#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Box plot</span></span>
<span id="cb13-8"><a href="determining-the-minimum-sampling-size.html#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boxplot</span>(KL <span class="sc">~</span> N, <span class="at">data=</span>results, <span class="at">axes =</span> <span class="cn">FALSE</span>,<span class="at">outline =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-9"><a href="determining-the-minimum-sampling-size.html#cb13-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>), <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb13-10"><a href="determining-the-minimum-sampling-size.html#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">4</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fl">0.02</span>, <span class="fl">0.36</span>, <span class="at">by=</span>.<span class="dv">06</span>),  <span class="at">label=</span><span class="fu">seq</span>(<span class="fl">0.02</span>, <span class="fl">0.36</span>, <span class="at">by=</span>.<span class="dv">06</span>), <span class="at">las=</span><span class="dv">3</span>)</span>
<span id="cb13-11"><a href="determining-the-minimum-sampling-size.html#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw legend</span></span>
<span id="cb13-12"><a href="determining-the-minimum-sampling-size.html#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">xpd=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-13"><a href="determining-the-minimum-sampling-size.html#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;top&quot;</span>, <span class="at">inset=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">15</span>) ,<span class="fu">c</span>(<span class="st">&quot;% coincidence&quot;</span>, <span class="st">&quot;KL divergence&quot;</span>), <span class="at">horiz=</span>T,<span class="at">cex=</span>.<span class="dv">9</span>,</span>
<span id="cb13-14"><a href="determining-the-minimum-sampling-size.html#cb13-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">box.lty=</span><span class="dv">0</span>,<span class="at">fill =</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-7a"></span>
<img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/fig-7a-1.png" alt="Boxplot of the dispersion in KL and % repressentativeness in the iteration trials for each sample size" width="768" />
<p class="caption">
Figure 4.3: Boxplot of the dispersion in KL and % repressentativeness in the iteration trials for each sample size
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="determining-the-minimum-sampling-size.html#cb14-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">xpd=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>We determine the minimum sample size and plot the evaluation results.</p>
<p>The following figure shows the cumulative distribution function (cdf) of the KL divergence and the % of representativeness with growing sample sizes. Representativeness increases with the increasing sample size, while KL divergence decreases as expected. The red dot identifies the trial with the minimum sample size for the area in relation to the covariates analysed.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="determining-the-minimum-sampling-size.html#cb15-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Plot cdf and minimum sampling point</span></span>
<span id="cb15-2"><a href="determining-the-minimum-sampling-size.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> xx</span>
<span id="cb15-3"><a href="determining-the-minimum-sampling-size.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> normalized</span>
<span id="cb15-4"><a href="determining-the-minimum-sampling-size.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-5"><a href="determining-the-minimum-sampling-size.html#cb15-5" aria-hidden="true" tabindex="-1"></a>  mydata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x,y)</span>
<span id="cb15-6"><a href="determining-the-minimum-sampling-size.html#cb15-6" aria-hidden="true" tabindex="-1"></a>  opti <span class="ot">&lt;-</span> mydata[mydata<span class="sc">$</span>x<span class="sc">==</span>minimum_n,]</span>
<span id="cb15-7"><a href="determining-the-minimum-sampling-size.html#cb15-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-8"><a href="determining-the-minimum-sampling-size.html#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_ly</span>(mydata,</span>
<span id="cb15-9"><a href="determining-the-minimum-sampling-size.html#cb15-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="sc">~</span>x,</span>
<span id="cb15-10"><a href="determining-the-minimum-sampling-size.html#cb15-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="sc">~</span>normalized,</span>
<span id="cb15-11"><a href="determining-the-minimum-sampling-size.html#cb15-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">mode =</span> <span class="st">&quot;lines+markers&quot;</span>,</span>
<span id="cb15-12"><a href="determining-the-minimum-sampling-size.html#cb15-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">&quot;scatter&quot;</span>,</span>
<span id="cb15-13"><a href="determining-the-minimum-sampling-size.html#cb15-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">name =</span> <span class="st">&quot;CDF (1âKL divergence)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-14"><a href="determining-the-minimum-sampling-size.html#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x,</span>
<span id="cb15-15"><a href="determining-the-minimum-sampling-size.html#cb15-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="sc">~</span>jj,</span>
<span id="cb15-16"><a href="determining-the-minimum-sampling-size.html#cb15-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">mode =</span> <span class="st">&quot;lines+markers&quot;</span>,</span>
<span id="cb15-17"><a href="determining-the-minimum-sampling-size.html#cb15-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&quot;scatter&quot;</span>,</span>
<span id="cb15-18"><a href="determining-the-minimum-sampling-size.html#cb15-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">yaxis =</span> <span class="st">&quot;y2&quot;</span>,</span>
<span id="cb15-19"><a href="determining-the-minimum-sampling-size.html#cb15-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">name =</span> <span class="st">&quot;KL divergence&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb15-20"><a href="determining-the-minimum-sampling-size.html#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>opti<span class="sc">$</span>x,</span>
<span id="cb15-21"><a href="determining-the-minimum-sampling-size.html#cb15-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="sc">~</span>opti<span class="sc">$</span>y,</span>
<span id="cb15-22"><a href="determining-the-minimum-sampling-size.html#cb15-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">yaxis =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb15-23"><a href="determining-the-minimum-sampling-size.html#cb15-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">mode =</span> <span class="st">&quot;markers&quot;</span>,</span>
<span id="cb15-24"><a href="determining-the-minimum-sampling-size.html#cb15-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">name =</span> <span class="st">&quot;Minimum N&quot;</span>,</span>
<span id="cb15-25"><a href="determining-the-minimum-sampling-size.html#cb15-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">&#39;#d62728&#39;</span>,<span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">width =</span> <span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb15-26"><a href="determining-the-minimum-sampling-size.html#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;N&quot;</span>, </span>
<span id="cb15-27"><a href="determining-the-minimum-sampling-size.html#cb15-27" aria-hidden="true" tabindex="-1"></a>                        <span class="at">showgrid =</span> T, </span>
<span id="cb15-28"><a href="determining-the-minimum-sampling-size.html#cb15-28" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dtick =</span> <span class="dv">50</span>, </span>
<span id="cb15-29"><a href="determining-the-minimum-sampling-size.html#cb15-29" aria-hidden="true" tabindex="-1"></a>                        <span class="at">tickfont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">11</span>)),</span>
<span id="cb15-30"><a href="determining-the-minimum-sampling-size.html#cb15-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;1âKL divergence (% CDF)&quot;</span>, <span class="at">showgrid =</span> F ),</span>
<span id="cb15-31"><a href="determining-the-minimum-sampling-size.html#cb15-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">yaxis2 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;KL divergence&quot;</span>,</span>
<span id="cb15-32"><a href="determining-the-minimum-sampling-size.html#cb15-32" aria-hidden="true" tabindex="-1"></a>                         <span class="at">overlaying =</span> <span class="st">&quot;y&quot;</span>, <span class="at">side =</span> <span class="st">&quot;right&quot;</span>),</span>
<span id="cb15-33"><a href="determining-the-minimum-sampling-size.html#cb15-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">orientation =</span> <span class="st">&quot;h&quot;</span>, <span class="at">y =</span> <span class="fl">1.2</span>, <span class="at">x =</span> <span class="fl">0.1</span>,</span>
<span id="cb15-34"><a href="determining-the-minimum-sampling-size.html#cb15-34" aria-hidden="true" tabindex="-1"></a>                         <span class="at">traceorder =</span> <span class="st">&quot;normal&quot;</span>),</span>
<span id="cb15-35"><a href="determining-the-minimum-sampling-size.html#cb15-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">margin =</span> <span class="fu">list</span>(<span class="at">t =</span> <span class="dv">50</span>, <span class="at">b =</span> <span class="dv">50</span>, <span class="at">r =</span> <span class="dv">100</span>, <span class="at">l =</span> <span class="dv">80</span>),</span>
<span id="cb15-36"><a href="determining-the-minimum-sampling-size.html#cb15-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">hovermode =</span> <span class="st">&#39;x&#39;</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb15-37"><a href="determining-the-minimum-sampling-size.html#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">config</span>(<span class="at">displayModeBar =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-8"></span>
<div id="htmlwidget-c5a6f68a1965567f00bf" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-c5a6f68a1965567f00bf">{"x":{"visdat":{"10f65a1070da":["function () ","plotlyVisDat"]},"cur_data":"10f65a1070da","attrs":{"10f65a1070da":{"x":{},"y":{},"mode":"lines+markers","name":"CDF (1âKL divergence)","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"10f65a1070da.1":{"x":{},"y":{},"mode":"lines+markers","name":"KL divergence","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","yaxis":"y2","inherit":true},"10f65a1070da.2":{"x":{},"y":{},"mode":"markers","name":"Minimum N","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","yaxis":"y","marker":{"size":8,"color":"#d62728","line":{"color":"black","width":1}},"inherit":true}},"layout":{"margin":{"b":50,"l":80,"t":50,"r":100},"xaxis":{"domain":[0,1],"automargin":true,"title":"N","showgrid":true,"dtick":50,"tickfont":{"size":11}},"yaxis":{"domain":[0,1],"automargin":true,"title":"1âKL divergence (% CDF)","showgrid":false},"yaxis2":{"title":"KL divergence","overlaying":"y","side":"right"},"legend":{"orientation":"h","y":1.2,"x":0.1,"traceorder":"normal"},"hovermode":"x","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displayModeBar":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0,0.0172566115511504,0.0342195815960641,0.050893906789729,0.0672844987631827,0.0833961855702932,0.0992337131099233,0.114801746523895,0.130104871571165,0.145147595978618,0.159934350768871,0.174469491565491,0.188757299875995,0.202801984353023,0.21660768203405,0.230178459559999,0.243518314373126,0.256631175894511,0.269520906681522,0.282191303565578,0.294646098770555,0.306888961012157,0.318923496578581,0.3307532503928,0.342381707056757,0.353812291877803,0.365048371877665,0.376093256784239,0.386950200006516,0.397622399592914,0.408112999173301,0.418425088884994,0.428561706282994,0.438525837234736,0.448320416799618,0.457948330093555,0.467412413138826,0.476715453699463,0.48586019210242,0.494849322044768,0.503685491387163,0.512371302933801,0.52090931519911,0.529302043161389,0.537551959003632,0.545661492841732,0.553633033440313,0.561468928916358,0.569171487430886,0.576742977868848,0.584185630507449,0.591501637673112,0.598693154387253,0.605762299001065,0.612711153819511,0.619541765714688,0.626256146728765,0.632856274666646,0.639344093678566,0.645721514832761,0.651990416678395,0.658152645798916,0.664210017355982,0.670164315624147,0.67601729451644,0.681770678100998,0.687426161108914,0.692985409433445,0.698450060620715,0.703821724352079,0.709101982918276,0.714292391685507,0.719394479553593,0.724409749406329,0.729339678554178,0.73418571916943,0.73894929871396,0.743631820359702,0.748234663401973,0.75275918366576,0.757206713905096,0.761578564195641,0.765876022320577,0.770100354149945,0.77425280401352,0.778334595067345,0.782346929654029,0.786290989656906,0.79016793684818,0.793978913231138,0.797725041376537,0.801407424753276,0.805027148053437,0.80858527751179,0.81208286121987,0.815520929434704,0.818900494882284,0.822222553055884,0.825488082509289,0.82869804514504,0.831853386497783,0.834955036012775,0.838003907319677,0.841000898501663,0.843946892359972,0.84684275667394,0.849689344456621,0.852487494206049,0.855238030152231,0.857941762499932,0.86059948766733,0.863211988520615,0.865780034604588,0.868304382369344,0.870785775393088,0.873224944601172,0.875622608481394,0.877979473295637,0.880296233287911,0.882573570888848,0.884812156916722,0.887012650775046,0.889175700646808,0.891301943685402,0.893392006202308,0.895446503851583,0.897466041811204,0.899451214961338,0.901402608059564,0.903320795913126,0.905206343548248,0.907059806376569,0.908881730358747,0.910672652165278,0.912433099334581,0.914163590428386,0.915864635184491,0.917536734666902,0.919180381413437,0.920796059580802,0.922384245087209,0.923945405752563,0.925480001436264,0.926988484172664,0.92847129830422,0.929928880612381,0.931361660446246,0.932770059849035,0.934154493682409,0.935515369748667,0.936853088910876,0.938168045210947,0.939460625985705,0.940731211980983,0.941980177463778,0.943207890332494,0.944414712225312,0.945600998626715,0.946767098972199,0.947913356751206,0.949040109608302,0.950147689442633,0.951236422505692,0.95230662949742,0.953358625660672,0.954392720874075,0.95540921974331,0.956408421690829,0.957390621044066,0.958356107122124,0.959305164321003,0.960238072197372,0.961155105550912,0.962056534505269,0.962942624587615,0.963813636806867,0.964669827730567,0.965511449560462,0.966338750206787,0.967151973361295,0.967951358569038,0.968737141298927,0.969509553013092,0.970268821235065,0.971015169616798,0.97174881800454,0.972469982503601,0.973178875542004,0.973875705933059,0.974560678936873,0.975233996320812,0.975895856418933,0.976546454190406,0.977185981276942,0.977814626059242,0.97843257371249,0.979040006260897,0.979637102631316,0.980224038705951,0.980800987374166,0.981368118583404,0.981925599389259,0.982473594004673,0.983012263848315,0.983541767592124,0.984062261208051,0.984573898014,0.985076828718992,0.985571201467556,0.986057161883369,0.986534853112149,0.987004415863822,0.987465988453969,0.987919706844571,0.988365704684054,0.988804113346659,0.989235061971142,0.98965867749881,0.990075084710915,0.990484406265409,0.990886762733076,0.991282272633046,0.991671052467706,0.99205321675702,0.992428878072259,0.992798147069161,0.993161132520529,0.993517941348266,0.993868678654877,0.99421344775442,0.994552350202948,0.994885485828414,0.995212952760084,0.995534847457438,0.995851264738586,0.996162297808195,0.996468038284946,0.99676857622852,0.997064000166128,0.997354397118585,0.997639852625946,0.997920450772701,0.998196274212543,0.998467404192717,0.998733920577949,0.998995901873974,0.999253425250659,0.999506566564736,0.999755400382145,1],"mode":"lines+markers","name":"CDF (1âKL divergence)","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[2.26034973324926,2.22165682772243,2.18362232741182,2.14623502877965,2.1094839189295,2.0733581723623,2.03784714778757,2.00294038498886,1.96862760174261,1.93489869078936,1.90174371685651,1.86915291373181,1.8371166813866,1.80562558314793,1.77467034291895,1.74424184244649,1.71433111863516,1.68492936090714,1.65602790860697,1.62761824845039,1.59969201201668,1.5722409732836,1.54525704620436,1.51873228232575,1.4926588684468,1.46702912431735,1.44183550037572,1.41707057552485,1.3927270549464,1.36879776795191,1.34527566587059,1.32215381997309,1.2994254194305,1.27708376930817,1.25512228859362,1.23353450825803,1.2123140693507,1.19145472112593,1.17095031920181,1.1507948237503,1.13098229771812,1.11150690507793,1.09236290910923,1.07354467070859,1.0550466467285,1.03686338834465,1.01898953945086,1.00141983508137,0.984149099860025,0.967172246475745,0.950484274184033,0.934080267333929,0.917955393920044,0.902104904159236,0.886524129091499,0.871208479204661,0.856153443082492,0.841354586075804,0.82680754899617,0.812508046831874,0.798451867485707,0.784634870534235,0.771052986008193,0.757702213193621,0.744578619453404,0.731678339068865,0.718997572101069,0.706532583271502,0.694279700861801,0.682235315632202,0.670395879758392,0.658757905786456,0.647317965605598,0.636072689438357,0.625018764847989,0.614152935762751,0.603472001516783,0.592972815907313,0.582652286267903,0.572507372557467,0.562535086464783,0.552732490528258,0.543096697270654,0.533624868348549,0.524314213716266,0.515161990804033,0.506165503710121,0.497322102406734,0.48862918195941,0.480084181759708,0.471684584770944,0.463427916786766,0.455311745702353,0.447333680798,0.439491372034904,0.431782509362933,0.424204822040171,0.416756077964039,0.409434083013806,0.40223668040428,0.395161750050504,0.388207207943252,0.381371005535165,0.37465112913732,0.368045599326078,0.361552470360013,0.355169829606778,0.348895796979709,0.342728524384025,0.336666195172446,0.33070702361008,0.324849254348409,0.319091161908233,0.313431050171404,0.307867251881219,0.302398128151302,0.297022067982854,0.291737487790113,0.286542830933888,0.281436567263029,0.276417192663707,0.271483228616355,0.266633221760152,0.261865743464917,0.257179389410291,0.252572779172073,0.248044555815601,0.243593385496049,0.239217957065528,0.234916981686868,0.230689192453978,0.226533344018661,0.222448212223781,0.218432593742676,0.214485305724695,0.210605185446784,0.206791089970985,0.203041895807771,0.19935649858511,0.195733812723154,0.192172771114473,0.188672324809722,0.185231442708661,0.18184911125643,0.178524334144997,0.175256132019679,0.172043542190664,0.168885618349437,0.165781430290032,0.162730063635033,0.159730619566227,0.156782214559847,0.153883980126323,0.151035062554453,0.148234622659934,0.145481835538169,0.142775890321281,0.140115989939263,0.137501350885189,0.134931202984423,0.132404789167755,0.129921365248398,0.127480199702774,0.125080573455039,0.122721779665271,0.120403123521254,0.118123922033823,0.115883503835673,0.1136812089836,0.111516388764113,0.109388405502338,0.107296632374192,0.105240453221737,0.103219262371685,0.101232464456992,0.0992794742414842,0.0973597164474654,0.0954726255862668,0.0936176457916727,0.0917942306561838,0.090001843070066,0.0882399550631376,0.0865080476492499,0.0848056106734125,0.0831321426615212,0.0814871506726426,0.0798701501538118,0.0782806647973017,0.0767182264003203,0.0751823747270959,0.0736726573733086,0.0721886296328295,0.0707298543667264,0.0692959018744992,0.0678863497675065,0.0665007828445453,0.0651387929695489,0.0637999789513647,0.0624839464255786,0.0611903077383502,0.0599186818322241,0.058668694133885,0.0574399764438225,0.056232166827873,0.0550449095106074,0.0538778547705338,0.0527306588370817,0.0516029837893404,0.0504944974565205,0.0494048733201085,0.0483337904176867,0.0472809332483898,0.0462459916799701,0.0452286608574444,0.0442286411132947,0.043245637879198,0.0422793615992567,0.0413295276447072,0.0403958562300782,0.0394780723307768,0.0385759056020765,0.0376890902994836,0.0368173652004591,0.0359604735274721,0.0351181628723628,0.0342901851219929,0.0334762963851601,0.0326762569207574,0.0318898310671542,0.0311167871727793,0.0303568975278848,0.0296099382974718,0.0288756894553563,0.0281539347193585,0.0274444614875936,0.0267470607758477,0.0260615271560183,0.0253876586956038,0.0247252568982207,0.0240741266451348,0.023434076137786,0.0228049168412922,0.0221864634289134,0.0215785337274619,0.0209809486636405,0.0203935322112945,0.0198161113395608,0.0192485159618996,0.0186905788859935,0.0181421357644983],"mode":"lines+markers","name":"KL divergence","type":"scatter","yaxis":"y2","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","frame":null},{"x":[162],"y":[0.950147689442633],"mode":"markers","name":"Minimum N","type":"scatter","yaxis":"y","marker":{"color":"#d62728","size":8,"line":{"color":"black","width":1}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 4.4: KL Divergence and Proportion of Representativeness as function of sample size
</p>
</div>
<p>According to Figure <a href="determining-the-minimum-sampling-size.html#fig:fig-8">4.4</a>, the minimum sampling size for the area, which captures at least 95% of the environmental variability of covariates is N = 162.</p>
<p>Finally, we can determine the optimal distribution of samples over the study area according to these specific results, taking into account the minimum sampling size and the increasing interval in the sample size. The results are shown in Figure <a href="determining-the-minimum-sampling-size.html#fig:fig-9">4.5</a>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="determining-the-minimum-sampling-size.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Determine the optimal iteration according to the minimum N size </span></span>
<span id="cb16-2"><a href="determining-the-minimum-sampling-size.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  optimal_iteration <span class="ot">&lt;-</span> results[<span class="fu">which</span>(<span class="fu">abs</span>(results<span class="sc">$</span>N <span class="sc">-</span> minimum_n) <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">abs</span>(results<span class="sc">$</span>N <span class="sc">-</span> minimum_n))),] <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="determining-the-minimum-sampling-size.html#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">IDX =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="determining-the-minimum-sampling-size.html#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Perc<span class="sc">==</span><span class="fu">max</span>(Perc)) </span>
<span id="cb16-5"><a href="determining-the-minimum-sampling-size.html#cb16-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-6"><a href="determining-the-minimum-sampling-size.html#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot best iteration points</span></span>
<span id="cb16-7"><a href="determining-the-minimum-sampling-size.html#cb16-7" aria-hidden="true" tabindex="-1"></a>  N_final <span class="ot">&lt;-</span> samples_storage[<span class="fu">paste0</span>(<span class="st">&quot;N&quot;</span>,optimal_iteration<span class="sc">$</span>N,<span class="st">&quot;_&quot;</span>, optimal_iteration<span class="sc">$</span>IDX)][[<span class="dv">1</span>]]</span>
<span id="cb16-8"><a href="determining-the-minimum-sampling-size.html#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(cov.dat[[<span class="dv">1</span>]])</span>
<span id="cb16-9"><a href="determining-the-minimum-sampling-size.html#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(N_final)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-9"></span>
<img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/fig-9-1.png" alt="Covariates and optimal distribution of samples" width="672" />
<p class="caption">
Figure 4.5: Covariates and optimal distribution of samples
</p>
</div>
<p>In summary, we utilize the variability within the covariate data to ascertain the minimum number of samples required to capture a minimum of 95% of this variability. Our approach involves assessing the similarities in variability between the sample space and the population space (study area) through calculations of the KullbackâLeibler (KL) divergence and the percentage of similarity at various stages of increasing sample sizes. These results are then utilized to fit a model representing the expected distribution of representativeness as a function of sample size. This model guides us in determining the minimum sample size necessary to achieve a representation of at least 95% of the environmental diversity within the area</p>

</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-Roudier2011" class="csl-entry">
<strong>Roudier, P., Brugnard, C., Beaudette, D., Louis, B., Daust, K. &amp; Clifford, D.</strong> 2011. <em>Clhs: A r package for conditioned latin hypercube sampling</em>. (also available at <a href="https://cran.r-project.org/web/packages/clhs/">https://cran.r-project.org/web/packages/clhs/</a>).
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="legacy_data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stratified-simple-random-sampling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/luislado/Sampling_Design_GSP/edit/master/04-Sample-size.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Technical Manual Soil Sampling Design.pdf", "Technical Manual Soil Sampling Design.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
