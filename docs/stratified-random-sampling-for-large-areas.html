<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.2 Stratified random sampling for large areas |  Soil Sampling Design</title>
  <meta name="description" content="Technical Manual on Soil Sampling Design - SoilFer Project" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="4.2 Stratified random sampling for large areas |  Soil Sampling Design" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Technical Manual on Soil Sampling Design - SoilFer Project" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.2 Stratified random sampling for large areas |  Soil Sampling Design" />
  
  <meta name="twitter:description" content="Technical Manual on Soil Sampling Design - SoilFer Project" />
  

<meta name="author" content="RodrÃ­guez Lado, L., Angelini, M.E, Naypewe, N., Luotto, I., Yigini, Y." />


<meta name="date" content="2023-12-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="general-procedure.html"/>
<link rel="next" href="stratified-regular-sampling.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="assets/plotly-binding-4.10.0/plotly.js"></script>
<script src="assets/typedarray-0.1/typedarray.min.js"></script>
<link href="assets/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="assets/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="assets/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="assets/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="assets/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-1.3.1/leaflet.js"></script>
<link href="assets/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="assets/proj4-2.6.2/proj4.min.js"></script>
<script src="assets/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="assets/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="assets/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="assets/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<link href="assets/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="assets/HomeButton-0.0.1/home-button.js"></script>
<script src="assets/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="assets/clipboard-0.0.1/setClipboardText.js"></script>
<link href="assets/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="assets/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Licence</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="manual-structure.html"><a href="manual-structure.html"><i class="fa fa-check"></i><b>1.1</b> Manual Structure</a></li>
<li class="chapter" data-level="" data-path="conditioned-latin-hypercube-sampling-clhs.html"><a href="conditioned-latin-hypercube-sampling-clhs.html"><i class="fa fa-check"></i>Conditioned Latin Hypercube Sampling (cLHS)</a></li>
</ul></li>
<li class="part"><span><b>Part one - Soil Legacy Data</b></span></li>
<li class="chapter" data-level="2" data-path="legacy_data.html"><a href="legacy_data.html"><i class="fa fa-check"></i><b>2</b> Evaluating Soil Legacy Data Sampling for DSM</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-preparation.html"><a href="data-preparation.html"><i class="fa fa-check"></i><b>2.1</b> Data Preparation</a></li>
<li class="chapter" data-level="2.2" data-path="representativeness-of-the-legacy-soil-data.html"><a href="representativeness-of-the-legacy-soil-data.html"><i class="fa fa-check"></i><b>2.2</b> Representativeness of the Legacy Soil Data</a></li>
</ul></li>
<li class="part"><span><b>I Part two - Soil Sampling Design</b></span></li>
<li class="chapter" data-level="3" data-path="creating-a-sampling-design.html"><a href="creating-a-sampling-design.html"><i class="fa fa-check"></i><b>3</b> Creating a sampling design</a>
<ul>
<li class="chapter" data-level="3.1" data-path="determining-the-optimal-sample-size.html"><a href="determining-the-optimal-sample-size.html"><i class="fa fa-check"></i><b>3.1</b> Determining the optimal sample size</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="stratified-sampling-design.html"><a href="stratified-sampling-design.html"><i class="fa fa-check"></i><b>4</b> Stratified Sampling Design</a>
<ul>
<li class="chapter" data-level="4.1" data-path="general-procedure.html"><a href="general-procedure.html"><i class="fa fa-check"></i><b>4.1</b> General Procedure</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="general-procedure.html"><a href="general-procedure.html#strata-creation"><i class="fa fa-check"></i><b>4.1.1</b> Strata creation</a></li>
<li class="chapter" data-level="4.1.2" data-path="general-procedure.html"><a href="general-procedure.html#stratified-random-sampling"><i class="fa fa-check"></i><b>4.1.2</b> Stratified random sampling</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="stratified-random-sampling-for-large-areas.html"><a href="stratified-random-sampling-for-large-areas.html"><i class="fa fa-check"></i><b>4.2</b> Stratified random sampling for large areas</a></li>
<li class="chapter" data-level="4.3" data-path="stratified-regular-sampling.html"><a href="stratified-regular-sampling.html"><i class="fa fa-check"></i><b>4.3</b> Stratified regular sampling</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p><img src="images/frontcover.png" style="top:0px;height:300px;" align="right" />
Soil Sampling Design</p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="stratified-random-sampling-for-large-areas" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Stratified random sampling for large areas<a href="stratified-random-sampling-for-large-areas.html#stratified-random-sampling-for-large-areas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The implementation of a stratified random sampling, along with target and replacement points, can present operating difficulties when dealing with areas of significant size and with locations that are hard to reach. To address this issue, the sampling approach can be modified by excluding areas with limited accessibility.</p>
<p>This modification can streamline fieldwork operations and establish a feasible sampling method while still retaining the essence of the stratified random sampling framework. By excluding areas with limited accessibility, the sampling design can be adjusted to ensure a more practical and effective approach to data collection.</p>
<ul>
<li><p><strong>Delineation of sampling accessibility:</strong> The sampling area can be further limited based on accessibility considerations. Areas with very limited accessibility, defined as regions located more than 1 kilometre away from a main road or access path, may be excluded from sampling areas. To accomplish this, a map of main roads and paths can be used to establish a sampling buffer that includes areas within a 1-kilometre buffer around the road infrastructures. This exclusion helps to eliminate the most remote and challenging-to-access areas. An additional layer of accessibility information can be incorporated based on population distribution in the country, considering that, if population is present, there is a high change that points in the surroundings can be accessible for sampling. In this case, populated nuclei are vectorized into points, and a 250-meter buffer is then generated around each point. These resulting areas can be then added to the 1-kilometre buffer around the roads, which collectively defined the final sampling area.</p></li>
<li><p><strong>Substitution of replacement points with replacement areas in close proximity to the target points:</strong> The sampling design presented before included designated replacement points to serve as substitutes for each target point in the case that it would be inaccessible during fieldwork. However, this approach presented challenges, particularly for large areas, as the replacement point could be located far from the target point, resulting in significant logistical efforts. This limitation posed a risk of delays in completing the sampling campaign within the allocated time frame. To address this challenge, an alternative strategy is to replace the idea of replacement points with replacement areas situated in the immediate vicinity of the target point. The replacement area for each target point is now confined within a 500-meter buffer surrounding the target and falls within the same sampling stratum. This approach concentrates sampling and replacement activities within a specific geographic area, streamlining the overall process. By reducing the need for extensive travel, this method enhances efficiency and facilitates sample collection. Figure 2 illustrates the distribution of sampling points and replacement areas for visualization.</p></li>
<li><p><strong>Additional area exclusion:</strong> Some areas can be identified as not suitable for sampling purposes. This is the case of certain natural protected areas, conflict regions presenting risks for field operators, etc. These areas must be identified masked at an initial stage of the design to exclude them from the sampling strata.</p></li>
</ul>
<p>The procedure is the same as that previously presented, with the difference that buffers and exclusion areas must be masked-out from the strata map before performing the random-sampling.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="stratified-random-sampling-for-large-areas.html#cb26-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Compute sampling areas WITH REPLACEMENT -----</span></span>
<span id="cb26-2"><a href="stratified-random-sampling-for-large-areas.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(REPLACEMENT){</span>
<span id="cb26-3"><a href="stratified-random-sampling-for-large-areas.html#cb26-3" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Load strata</span></span>
<span id="cb26-4"><a href="stratified-random-sampling-for-large-areas.html#cb26-4" aria-hidden="true" tabindex="-1"></a>      soil_lc <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;../soil_sampling/JAM/strata.shp&quot;</span>)</span>
<span id="cb26-5"><a href="stratified-random-sampling-for-large-areas.html#cb26-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-6"><a href="stratified-random-sampling-for-large-areas.html#cb26-6" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Read sampling. points from previous step</span></span>
<span id="cb26-7"><a href="stratified-random-sampling-for-large-areas.html#cb26-7" aria-hidden="true" tabindex="-1"></a>      z <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;../soil_sampling/JAM/sampling_points.shp&quot;</span>)</span>
<span id="cb26-8"><a href="stratified-random-sampling-for-large-areas.html#cb26-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-9"><a href="stratified-random-sampling-for-large-areas.html#cb26-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Define buffer of 500 meters (coordinate system must be in metric base)</span></span>
<span id="cb26-10"><a href="stratified-random-sampling-for-large-areas.html#cb26-10" aria-hidden="true" tabindex="-1"></a>      samples.buffer <span class="ot">=</span> <span class="dv">500</span></span>
<span id="cb26-11"><a href="stratified-random-sampling-for-large-areas.html#cb26-11" aria-hidden="true" tabindex="-1"></a>      buf.samples <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(z, <span class="at">dist=</span>samples.buffer)</span>
<span id="cb26-12"><a href="stratified-random-sampling-for-large-areas.html#cb26-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-13"><a href="stratified-random-sampling-for-large-areas.html#cb26-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Intersect buffers</span></span>
<span id="cb26-14"><a href="stratified-random-sampling-for-large-areas.html#cb26-14" aria-hidden="true" tabindex="-1"></a>      samples_buffer <span class="ot">=</span> <span class="fu">st_intersection</span>(soil_lc, buf.samples)</span>
<span id="cb26-15"><a href="stratified-random-sampling-for-large-areas.html#cb26-15" aria-hidden="true" tabindex="-1"></a>      samples_buffer <span class="ot">&lt;-</span> samples_buffer[samples_buffer<span class="sc">$</span>type<span class="sc">==</span><span class="st">&quot;Target&quot;</span>,]</span>
<span id="cb26-16"><a href="stratified-random-sampling-for-large-areas.html#cb26-16" aria-hidden="true" tabindex="-1"></a>      samples_buffer <span class="ot">&lt;-</span> samples_buffer[samples_buffer<span class="sc">$</span>soil_lc<span class="sc">==</span>samples_buffer<span class="sc">$</span>group,]</span>
<span id="cb26-17"><a href="stratified-random-sampling-for-large-areas.html#cb26-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Save Sampling areas</span></span>
<span id="cb26-18"><a href="stratified-random-sampling-for-large-areas.html#cb26-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_write</span>(samples_buffer, <span class="fu">paste0</span>(<span class="st">&#39;../soil_sampling/JAM/replacement_areas_&#39;</span>, samples.buffer, <span class="st">&#39;.shp&#39;</span>), <span class="at">delete_dsn =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-19"><a href="stratified-random-sampling-for-large-areas.html#cb26-19" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-20"><a href="stratified-random-sampling-for-large-areas.html#cb26-20" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Write target points only</span></span>
<span id="cb26-21"><a href="stratified-random-sampling-for-large-areas.html#cb26-21" aria-hidden="true" tabindex="-1"></a>      targets <span class="ot">&lt;-</span> z[z<span class="sc">$</span>type<span class="sc">==</span><span class="st">&quot;Target&quot;</span>,]</span>
<span id="cb26-22"><a href="stratified-random-sampling-for-large-areas.html#cb26-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_write</span>(targets, <span class="st">&#39;../soil_sampling/JAM/sampling_points_TAR.shp&#39;</span>, <span class="at">delete_dsn =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-23"><a href="stratified-random-sampling-for-large-areas.html#cb26-23" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="general-procedure.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stratified-regular-sampling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

</body>

</html>
